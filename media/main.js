"use strict";(()=>{var pe=Object.create;var re=Object.defineProperty;var ve=Object.getOwnPropertyDescriptor;var ge=Object.getOwnPropertyNames;var ye=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty;var T=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var he=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ge(e))!me.call(t,a)&&a!==r&&re(t,a,{get:()=>e[a],enumerable:!(n=ve(e,a))||n.enumerable});return t};var xe=(t,e,r)=>(r=t!=null?pe(ye(t)):{},he(e||!t||!t.__esModule?re(r,"default",{value:t,enumerable:!0}):r,t));var J=T(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.loop=C.conditional=C.parse=void 0;var Be=function t(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;if(Array.isArray(r))r.forEach(function(d){return t(e,d,n,a)});else if(typeof r=="function")r(e,n,a,t);else{var o=Object.keys(r)[0];Array.isArray(r[o])?(a[o]={},t(e,r[o],n,a[o])):a[o]=r[o](e,n,a,t)}return n};C.parse=Be;var be=function(e,r){return function(n,a,o,d){r(n,a,o)&&d(n,e,a,o)}};C.conditional=be;var we=function(e,r){return function(n,a,o,d){for(var i=[],l=n.pos;r(n,a,o);){var u={};if(d(n,e,a,u),n.pos===l)break;l=n.pos,i.push(u)}return i}};C.loop=we});var Q=T(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.readBits=p.readArray=p.readUnsigned=p.readString=p.peekBytes=p.readBytes=p.peekByte=p.readByte=p.buildStream=void 0;var Ae=function(e){return{data:e,pos:0}};p.buildStream=Ae;var ne=function(){return function(e){return e.data[e.pos++]}};p.readByte=ne;var _e=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(r){return r.data[r.pos+e]}};p.peekByte=_e;var H=function(e){return function(r){return r.data.subarray(r.pos,r.pos+=e)}};p.readBytes=H;var Se=function(e){return function(r){return r.data.subarray(r.pos,r.pos+e)}};p.peekBytes=Se;var ke=function(e){return function(r){return Array.from(H(e)(r)).map(function(n){return String.fromCharCode(n)}).join("")}};p.readString=ke;var Ce=function(e){return function(r){var n=H(2)(r);return e?(n[1]<<8)+n[0]:(n[0]<<8)+n[1]}};p.readUnsigned=Ce;var Fe=function(e,r){return function(n,a,o){for(var d=typeof r=="function"?r(n,a,o):r,i=H(e),l=new Array(d),u=0;u<d;u++)l[u]=i(n);return l}};p.readArray=Fe;var Ie=function(e,r,n){for(var a=0,o=0;o<n;o++)a+=e[r+o]&&Math.pow(2,n-o-1);return a},Ee=function(e){return function(r){for(var n=ne()(r),a=new Array(8),o=0;o<8;o++)a[7-o]=!!(n&1<<o);return Object.keys(e).reduce(function(d,i){var l=e[i];return l.length?d[i]=Ie(a,l.index,l.length):d[i]=a[l.index],d},{})}};p.readBits=Ee});var ae=T(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.default=void 0;var F=J(),s=Q(),j={blocks:function(e){for(var r=0,n=[],a=e.data.length,o=0,d=(0,s.readByte)()(e);d!==r&&d;d=(0,s.readByte)()(e)){if(e.pos+d>=a){var i=a-e.pos;n.push((0,s.readBytes)(i)(e)),o+=i;break}n.push((0,s.readBytes)(d)(e)),o+=d}for(var l=new Uint8Array(o),u=0,f=0;f<n.length;f++)l.set(n[f],u),u+=n[f].length;return l}},Ue=(0,F.conditional)({gce:[{codes:(0,s.readBytes)(2)},{byteSize:(0,s.readByte)()},{extras:(0,s.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,s.readUnsigned)(!0)},{transparentColorIndex:(0,s.readByte)()},{terminator:(0,s.readByte)()}]},function(t){var e=(0,s.peekBytes)(2)(t);return e[0]===33&&e[1]===249}),Me=(0,F.conditional)({image:[{code:(0,s.readByte)()},{descriptor:[{left:(0,s.readUnsigned)(!0)},{top:(0,s.readUnsigned)(!0)},{width:(0,s.readUnsigned)(!0)},{height:(0,s.readUnsigned)(!0)},{lct:(0,s.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,F.conditional)({lct:(0,s.readArray)(3,function(t,e,r){return Math.pow(2,r.descriptor.lct.size+1)})},function(t,e,r){return r.descriptor.lct.exists}),{data:[{minCodeSize:(0,s.readByte)()},j]}]},function(t){return(0,s.peekByte)()(t)===44}),Te=(0,F.conditional)({text:[{codes:(0,s.readBytes)(2)},{blockSize:(0,s.readByte)()},{preData:function(e,r,n){return(0,s.readBytes)(n.text.blockSize)(e)}},j]},function(t){var e=(0,s.peekBytes)(2)(t);return e[0]===33&&e[1]===1}),Pe=(0,F.conditional)({application:[{codes:(0,s.readBytes)(2)},{blockSize:(0,s.readByte)()},{id:function(e,r,n){return(0,s.readString)(n.blockSize)(e)}},j]},function(t){var e=(0,s.peekBytes)(2)(t);return e[0]===33&&e[1]===255}),ze=(0,F.conditional)({comment:[{codes:(0,s.readBytes)(2)},j]},function(t){var e=(0,s.peekBytes)(2)(t);return e[0]===33&&e[1]===254}),De=[{header:[{signature:(0,s.readString)(3)},{version:(0,s.readString)(3)}]},{lsd:[{width:(0,s.readUnsigned)(!0)},{height:(0,s.readUnsigned)(!0)},{gct:(0,s.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,s.readByte)()},{pixelAspectRatio:(0,s.readByte)()}]},(0,F.conditional)({gct:(0,s.readArray)(3,function(t,e){return Math.pow(2,e.lsd.gct.size+1)})},function(t,e){return e.lsd.gct.exists}),{frames:(0,F.loop)([Ue,Pe,ze,Me,Te],function(t){var e=(0,s.peekByte)()(t);return e===33||e===44})}],Le=De;O.default=Le});var ie=T(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.deinterlace=void 0;var qe=function(e,r){for(var n=new Array(e.length),a=e.length/r,o=function(E,v){var c=e.slice(v*r,(v+1)*r);n.splice.apply(n,[E*r,r].concat(c))},d=[0,4,2,1],i=[8,8,4,2],l=0,u=0;u<4;u++)for(var f=d[u];f<a;f+=i[u])o(f,l),l++;return n};N.deinterlace=qe});var oe=T(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.lzw=void 0;var Ge=function(e,r,n){var a=4096,o=-1,d=n,i,l,u,f,b,E,v,m,c,w,h,S,x,_,G,q,M=new Array(n),k=new Array(a),U=new Array(a),y=new Array(a+1);for(S=e,l=1<<S,b=l+1,i=l+2,v=o,f=S+1,u=(1<<f)-1,c=0;c<l;c++)k[c]=0,U[c]=c;var h,m,A,x,_,q,G;for(h=m=A=x=_=q=G=0,w=0;w<d;){if(_===0){if(m<f){h+=r[G]<<m,m+=8,G++;continue}if(c=h&u,h>>=f,m-=f,c>i||c==b)break;if(c==l){f=S+1,u=(1<<f)-1,i=l+2,v=o;continue}if(v==o){y[_++]=U[c],v=c,x=c;continue}for(E=c,c==i&&(y[_++]=x,c=v);c>l;)y[_++]=U[c],c=k[c];x=U[c]&255,y[_++]=x,i<a&&(k[i]=v,U[i]=x,i++,!(i&u)&&i<a&&(f++,u+=i)),v=E}_--,M[q++]=y[_],w++}for(w=q;w<d;w++)M[w]=0;return M};R.lzw=Ge});var de=T(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.decompressFrames=I.decompressFrame=I.parseGIF=void 0;var He=$e(ae()),je=J(),Oe=Q(),Ne=ie(),Re=oe();function $e(t){return t&&t.__esModule?t:{default:t}}var We=function(e){var r=new Uint8Array(e);return(0,je.parse)((0,Oe.buildStream)(r),He.default)};I.parseGIF=We;var Xe=function(e){for(var r=e.pixels.length,n=new Uint8ClampedArray(r*4),a=0;a<r;a++){var o=a*4,d=e.pixels[a],i=e.colorTable[d]||[0,0,0];n[o]=i[0],n[o+1]=i[1],n[o+2]=i[2],n[o+3]=d!==e.transparentIndex?255:0}return n},se=function(e,r,n){if(!e.image){console.warn("gif frame does not have associated image.");return}var a=e.image,o=a.descriptor.width*a.descriptor.height,d=(0,Re.lzw)(a.data.minCodeSize,a.data.blocks,o);a.descriptor.lct.interlaced&&(d=(0,Ne.deinterlace)(d,a.descriptor.width));var i={pixels:d,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return a.descriptor.lct&&a.descriptor.lct.exists?i.colorTable=a.lct:i.colorTable=r,e.gce&&(i.delay=(e.gce.delay||10)*10,i.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(i.transparentIndex=e.gce.transparentColorIndex)),n&&(i.patch=Xe(i)),i};I.decompressFrame=se;var Ke=function(e,r){return e.frames.filter(function(n){return n.image}).map(function(n){return se(n,e.gct,r)})};I.decompressFrames=Ke});var V=xe(de()),Ve=acquireVsCodeApi?.(),Y=document.getElementById("canvas"),Ze=Y.getContext("2d"),te=document.getElementById("play"),Je=document.getElementById("prev"),Qe=document.getElementById("next"),X=document.getElementById("progress"),le=document.getElementById("speed"),ee=document.getElementById("info"),g=[],B=0,D=!1,$=1,K=null,P=0,W=0,ce=0,Ye=2e3;function z(t){ee.textContent=t}function et(t){let e=atob(t),r=e.length,n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=e.charCodeAt(a);return n.buffer}async function ue(t){try{z("\u89E3\u6790\u4E2D...");let e=et(t),r=(0,V.parseGIF)(e),n=(0,V.decompressFrames)(r,!0);if(!n.length){z("\u65E0\u6709\u6548\u5E27"),g=[];return}let a=r.lsd?.width||n[0].dims.width,o=r.lsd?.height||n[0].dims.height,d=[],i=new Uint8ClampedArray(a*o*4),l=null;for(let f=0;f<n.length;f++){let b=n[f],E=b.disposalType;E===3?l=new Uint8ClampedArray(i):l=null;let v=new Uint8ClampedArray(i),{left:c,top:w,width:S,height:M}=b.dims,k=b.patch;for(let y=0;y<M;y++)for(let h=0;h<S;h++){let m=(y*S+h)*4,A=k[m+3];if(A===0)continue;let x=((w+y)*a+(c+h))*4;v[x]=k[m],v[x+1]=k[m+1],v[x+2]=k[m+2],v[x+3]=A}let U=new ImageData(v,a,o);switch(d.push({delay:Math.max(10,b.delay||0),imageData:U}),E){case 2:{let y=new Uint8ClampedArray(v);for(let h=0;h<M;h++)for(let m=0;m<S;m++){let A=((w+h)*a+(c+m))*4;y[A]=0,y[A+1]=0,y[A+2]=0,y[A+3]=0}i=y;break}case 3:{l?i=new Uint8ClampedArray(l):i=new Uint8ClampedArray(v);break}case 0:case 1:default:i=new Uint8ClampedArray(v)}}g=d,ce=g.reduce((f,b)=>f+b.delay,0),X.max=String(g.length-1),Y.width=g[0].imageData.width,Y.height=g[0].imageData.height,B=0,L();let u="";g.length>Ye&&(u=" \u26A0\u5927\u91CF\u5E27, \u6027\u80FD\u53EF\u80FD\u4E0B\u964D"),z(`${g.length} \u5E27 / ${(ce/1e3).toFixed(2)}s${u}`)}catch(e){console.error(e),z("\u89E3\u6790\u5931\u8D25")}}function L(){if(!g.length)return;let t=g[B];Ze.putImageData(t.imageData,0,0),X.value=String(B)}function fe(t){if(!D)return;P||(P=t);let e=t-P;P=t,W+=e*$;let r=0;for(;W>=g[B].delay&&(W-=g[B].delay,B=(B+1)%g.length,r++,!(r>10)););L(),D&&(K=requestAnimationFrame(fe))}function tt(){g.length&&(D=!0,te.textContent="\u23F8",P=0,W=0,K=requestAnimationFrame(fe))}function Z(){D=!1,te.textContent="\u25B6",K&&cancelAnimationFrame(K)}te.addEventListener("click",()=>{D?Z():tt()});Je.addEventListener("click",()=>{Z(),g.length&&(B=(B-1+g.length)%g.length,L())});Qe.addEventListener("click",()=>{Z(),g.length&&(B=(B+1)%g.length,L())});X.addEventListener("input",()=>{Z(),B=Number(X.value),L()});le.addEventListener("change",()=>{let t=Number(le.value);t<.1?$=.1:t>4?$=4:$=t});window.addEventListener("message",t=>{let e=t.data;e.type==="reload"&&ue(e.data)});window.__initialGifBase64?ue(window.__initialGifBase64):Ve?.postMessage({type:"requestBytes"});window.__isLargeGif&&z((ee.textContent?ee.textContent+" ":"")+"\u26A0 \u6587\u4EF6\u8F83\u5927\uFF0C\u89E3\u6790\u53EF\u80FD\u8017\u65F6");})();
//# sourceMappingURL=main.js.map
